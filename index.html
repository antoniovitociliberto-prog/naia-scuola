<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Chat - Layout Fixed</title>
    <style>
        /* --- STILE DARK & LAYOUT --- */
        body {
            margin: 0;
            background-color: #121212;
            color: white;
            font-family: 'Segoe UI', sans-serif;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* 1. CHAT (IN ALTO) */
        #chat-interface {
            flex: 1; /* Prende tutto lo spazio in alto */
            padding: 20px;
            overflow-y: auto;
            background: rgba(255, 255, 255, 0.03);
            border-bottom: 1px solid #333;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .message {
            max-width: 80%;
            padding: 10px 15px;
            border-radius: 15px;
            font-size: 15px;
            animation: fadeIn 0.3s ease;
        }
        .user-msg { align-self: flex-end; background-color: #007bff; color: white; }
        .ai-msg { align-self: flex-start; background-color: #333; color: #ddd; }

        /* 2. AVATAR (AL CENTRO) */
        #avatar-container {
            height: 40%; /* Altezza dedicata all'avatar */
            display: flex;
            justify-content: center;
            align-items: center;
            background: radial-gradient(circle, #222 0%, #121212 80%);
            position: relative;
        }

        #avatar-img {
            max-height: 90%;
            max-width: 100%;
            object-fit: contain;
            filter: drop-shadow(0 0 20px rgba(0, 123, 255, 0.2));
            transition: transform 0.2s;
        }

        /* 3. INPUT (IN BASSO) */
        #input-area {
            padding: 20px;
            background-color: #1a1a1a;
            display: flex;
            gap: 10px;
            border-top: 1px solid #333;
        }

        input {
            flex-grow: 1;
            padding: 15px;
            border-radius: 30px;
            border: 1px solid #444;
            background: #2c2c2c;
            color: white;
            outline: none;
        }
        
        button {
            padding: 0 25px;
            border-radius: 30px;
            border: none;
            background: #007bff;
            color: white;
            font-weight: bold;
            cursor: pointer;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div id="chat-interface">
        <div class="message ai-msg">Sistema online. In attesa di input.</div>
    </div>

    <div id="avatar-container">
        <img id="avatar-img" src="https://media.tenor.com/On7KVX2S6WEAAAAj/loading-waiting.gif" alt="Avatar">
    </div>

    <div id="input-area">
        <input type="text" id="user-input" placeholder="Scrivi qui..." autofocus>
        <button id="send-btn">Invia</button>
    </div>

    <script>
        // ==========================================
        // CONFIGURAZIONE DEL CERVELLO (PROMPT)
        // ==========================================
        
        // MODIFICA QUI IL COMPORTAMENTO DELL'AI
        const SYSTEM_PROMPT = "Sei un assistente sarcastico e molto intelligente. Rispondi in modo breve e diretto.";
        
        // ==========================================

        const chatInterface = document.getElementById('chat-interface');
        const userInput = document.getElementById('user-input');
        const sendBtn = document.getElementById('send-btn');
        const avatarImg = document.getElementById('avatar-img');

        // URL Immagini per animazione base
        const avatarIdle = "https://media.tenor.com/On7KVX2S6WEAAAAj/loading-waiting.gif";
        const avatarTalk = "https://media.tenor.com/UnFy-P9X1mkAAAAj/hud-ui.gif";

        function aggiungiMessaggio(testo, sender) {
            const div = document.createElement('div');
            div.classList.add('message', sender === 'user' ? 'user-msg' : 'ai-msg');
            div.innerText = testo;
            chatInterface.appendChild(div);
            chatInterface.scrollTop = chatInterface.scrollHeight;
        }

        // --- SIMULAZIONE CHIAMATA AI (Cervello) ---
        async function elaboraRisposta(messaggioUtente) {
            // Qui simuliamo l'uso del SYSTEM_PROMPT.
            // In una vera API call, invieresti SYSTEM_PROMPT come messaggio di sistema.
            
            console.log("System Prompt Attivo:", SYSTEM_PROMPT); // Debug in console
            
            avatarImg.src = avatarTalk; // Avatar parla

            return new Promise(resolve => {
                setTimeout(() => {
                    // Risposta simulata basata sul prompt (logica finta per ora)
                    let risposta = "Sto elaborando la tua richiesta: '" + messaggioUtente + "'";
                    
                    // Esempio semplice: se il prompt dice "sarcastico", aggiungiamo un suffisso
                    if (SYSTEM_PROMPT.includes("sarcastico")) {
                        risposta += " ...sempre che ne valga la pena.";
                    }

                    resolve(risposta);
                }, 1500);
            });
        }

        async function gestisciInvio() {
            const testo = userInput.value.trim();
            if (!testo) return;

            aggiungiMessaggio(testo, 'user');
            userInput.value = '';

            const rispostaAI = await elaboraRisposta(testo);

            aggiungiMessaggio(rispostaAI, 'ai');
            avatarImg.src = avatarIdle; // Avatar smette di parlare
        }

        sendBtn.addEventListener('click', gestisciInvio);
        userInput.addEventListener('keypress', (e) => { if(e.key === 'Enter') gestisciInvio(); });

    </script>
</body>
</html>
